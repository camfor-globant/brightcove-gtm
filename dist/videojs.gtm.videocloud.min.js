/*
* videojs-ga - v0.4.1 - 2015-08-10
* Copyright (c) 2015 Michael Bensoussan
* Modified for Google Tag Manager by Isaac Abramowitz
* Licensed MIT
*/
(function(){var V=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};(videojs.registerPlugin||videojs.plugin)("ga",function(t){var n,e,a,i,r,l,s,o,d,c,u,h,v,f,p,m,g,y,_,M,k,P,T,C,w,N,E,L,S,b,z,F,j,x,I;null==t&&(t={}),(N=document.createElement("a")).href=document.referrer,self!==top&&"preview-players.brightcove.net"===window.location.host&&(N.hostname="studio.brightcove.com")?videojs.log("GTM plugin will not track events in Video Cloud Studio"):(u=(w=this).el().parentElement.id,a={},i="class-non-found",t.data_setup&&(M=JSON.parse(t.data_setup)).ga&&(a=M.ga),t.eventParentClass&&(i=t.eventParentClass),h=w.el().parentElement.classList.contains(i)?"1":"0",l=["player_load","video_load","percent_played","start","end","seek","play","pause","resize","volume_change","error","fullscreen"],p=t.eventsToTrack||a.eventsToTrack||l,T=t.percentsPlayedInterval||a.percentsPlayedInterval||25,c=t.eventCategory||a.eventCategory||"Brightcove Player",r=t.eventLabel||a.eventLabel,S=L=0,b=o=j=!(P=[]),e=v="",f={video_load:"Video Load",percent_played:"Percent played",start:"Media Begin",seek_start:"Seek start",seek_end:"Seek end",play:"Media Play",pause:"Media Pause",error:"Error",fullscreen_exit:"Fullscreen Exited",fullscreen_enter:"Fullscreen Entered",resize:"Resize",volume_change:"Volume Change",player_load:"Player Load",end:"Media Complete"},g=function(e){return t.eventNames&&t.eventNames[e]?t.eventNames[e]:a.eventNames&&a.eventNames[e]?a.eventNames[e]:f[e]?f[e]:e},n=/(\s|^)vjs-ad-(playing|loading)(\s|$)/,y=function(e){return n.test(e.el().className)},_=function(){y(w)||(v=r||(w.mediainfo&&w.mediainfo.id?w.mediainfo.id+" | "+w.mediainfo.name:this.currentSrc().split("/").slice(-1)[0].replace(/\.(\w{3,4})(\?.*)?$/i,"")),w.mediainfo&&w.mediainfo.id&&w.mediainfo.id!==e&&(e=w.mediainfo.id,S=L=0,b=o=j=!(P=[]),0<=V.call(p,"video_load")&&z(g("video_load"),!0)))},x=function(){var e,t,n,a,i;if(!y(w)){for(e=Math.round(this.currentTime()),t=Math.round(this.duration()),a=Math.round(e/t*100),n=i=T;i<=99;n=i+=T)n<=a&&V.call(P,n)<0&&(0<=V.call(p,"percent_played")&&0!==a&&z(n+"% Milestone Passed",!0),0<a&&P.push(n));0<=V.call(p,"seek")&&(S=L,L=e,1<Math.abs(S-L)&&(b=!0,z(g("seek_start"),!1,S),z(g("seek_end"),!1,L)))}},s=function(){y(w)||o||(z(g("end"),!0),o=!0)},C=function(){var e;y(w)||(e=Math.round(this.currentTime()),z(g("play"),!0,e),b=!1)},F=function(){if(!y(w)&&0<=V.call(p,"start")&&!j)return z(g("start"),!0),j=!0},k=function(){var e;y(w)||(e=Math.round(this.currentTime()))===Math.round(this.duration())||b||z(g("pause"),!0,e)},I=function(){var e;e=!0===this.muted()?0:this.volume(),z(g("volume_change"),!1,e)},E=function(){z(g("resize")+" - "+this.width()+"*"+this.height(),!0)},d=function(){var e;e=Math.round(this.currentTime()),z(g("error"),!0,e)},m=function(){var e;e=Math.round(this.currentTime()),("function"==typeof this.isFullscreen?this.isFullscreen():void 0)||("function"==typeof this.isFullScreen?this.isFullScreen():void 0)?z(g("fullscreen_enter"),!1,e):z(g("fullscreen_exit"),!1,e)},z=function(e){dataLayer.push({videoCategory:c,videoAction:e,videoLabel:v,event:"videoEvent",parentId:u,parentHasClass:h})},0<=V.call(p,"player_load")&&(self!==top?(document.referrer,1):(window.location.href,0)),this.ready(function(){if(this.on("loadedmetadata",_),this.on("timeupdate",x),0<=V.call(p,"end")&&this.on("ended",s),0<=V.call(p,"play")&&this.on("play",C),0<=V.call(p,"start")&&this.on("playing",F),0<=V.call(p,"pause")&&this.on("pause",k),0<=V.call(p,"volume_change")&&this.on("volumechange",I),0<=V.call(p,"resize")&&this.on("resize",E),0<=V.call(p,"error")&&this.on("error",d),0<=V.call(p,"fullscreen"))return this.on("fullscreenchange",m)}))})}).call(this);